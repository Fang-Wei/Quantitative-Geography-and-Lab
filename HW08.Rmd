##HW08
###**B04208025/地理三/林芳偉**

```{r}
rm(list = ls())

library(GISTools)
library(rgdal)
library(dplyr)
library(sp)
library(aspace)

t <- readOGR(dsn = "QG_Data6", layer = "Taiwan_Town", encoding = "UTF8")
t_atr <- data.frame(t)
t_atr$number <- 1

town <- data.frame(xtabs(t_atr$number ~ t_atr$COUNTY))
colnames(town) <- c("COUNTY", "Number")

a1 <- gUnaryUnion(t[which(t_atr$COUNTY==town[1,1]),])
a2 <- gUnaryUnion(t[which(t_atr$COUNTY==town[2,1]),])
a3 <- gUnaryUnion(t[which(t_atr$COUNTY==town[3,1]),])
a4 <- gUnaryUnion(t[which(t_atr$COUNTY==town[4,1]),])
a5 <- gUnaryUnion(t[which(t_atr$COUNTY==town[5,1]),])
a6 <- gUnaryUnion(t[which(t_atr$COUNTY==town[6,1]),])
a7 <- gUnaryUnion(t[which(t_atr$COUNTY==town[7,1]),])
a8 <- gUnaryUnion(t[which(t_atr$COUNTY==town[8,1]),])
a9 <- gUnaryUnion(t[which(t_atr$COUNTY==town[9,1]),])
a10 <- gUnaryUnion(t[which(t_atr$COUNTY==town[10,1]),])
a11 <- gUnaryUnion(t[which(t_atr$COUNTY==town[11,1]),])
a12 <- gUnaryUnion(t[which(t_atr$COUNTY==town[12,1]),])
a13 <- gUnaryUnion(t[which(t_atr$COUNTY==town[13,1]),])
a14 <- gUnaryUnion(t[which(t_atr$COUNTY==town[14,1]),])
a15 <- gUnaryUnion(t[which(t_atr$COUNTY==town[15,1]),])
a16 <- gUnaryUnion(t[which(t_atr$COUNTY==town[16,1]),])
a17 <- gUnaryUnion(t[which(t_atr$COUNTY==town[17,1]),])
a18 <- gUnaryUnion(t[which(t_atr$COUNTY==town[18,1]),])
a19 <- gUnaryUnion(t[which(t_atr$COUNTY==town[19,1]),])
a20 <- gUnaryUnion(t[which(t_atr$COUNTY==town[20,1]),])
a21 <- gUnaryUnion(t[which(t_atr$COUNTY==town[21,1]),])
a22 <- gUnaryUnion(t[which(t_atr$COUNTY==town[22,1]),])
a23 <- gUnaryUnion(t[which(t_atr$COUNTY==town[23,1]),])


c1 <- gCentroid(a1, byid = T)
c2 <- gCentroid(a2, byid = T)
c3 <- gCentroid(a3, byid = T)
c4 <- gCentroid(a4, byid = T)
c5 <- gCentroid(a5, byid = T)
c6 <- gCentroid(a6, byid = T)
c7 <- gCentroid(a7, byid = T)
c8 <- gCentroid(a8, byid = T)
c9 <- gCentroid(a9, byid = T)
c10 <- gCentroid(a10, byid = T)
c11<- gCentroid(a11, byid = T)
c12 <- gCentroid(a12, byid = T)
c13 <- gCentroid(a13, byid = T)
c14 <- gCentroid(a14, byid = T)
c15 <- gCentroid(a15, byid = T)
c16 <- gCentroid(a16, byid = T)
c17 <- gCentroid(a17, byid = T)
c18 <- gCentroid(a18, byid = T)
c19 <- gCentroid(a19, byid = T)
c20 <- gCentroid(a20, byid = T)
c21 <- gCentroid(a21, byid = T)
c22 <- gCentroid(a22, byid = T)
c23 <- gCentroid(a23, byid = T)

cen <- data.frame(gCentroid(t, byid = T))
p1 <- mean_centre(id=1, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[1,1]),4], points=cen[which(t_atr$COUNTY==town[1,1]),1:2])
p2 <- mean_centre(id=2, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[2,1]),4], points=cen[which(t_atr$COUNTY==town[2,1]),1:2])
p3 <- mean_centre(id=3, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[3,1]),4], points=cen[which(t_atr$COUNTY==town[3,1]),1:2])
p4 <- mean_centre(id=4, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[4,1]),4], points=cen[which(t_atr$COUNTY==town[4,1]),1:2])
p5 <- mean_centre(id=5, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[5,1]),4], points=cen[which(t_atr$COUNTY==town[5,1]),1:2])
p6 <- mean_centre(id=6, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[6,1]),4], points=cen[which(t_atr$COUNTY==town[6,1]),1:2])
p7 <- mean_centre(id=7, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[7,1]),4], points=cen[which(t_atr$COUNTY==town[7,1]),1:2])
p8 <- mean_centre(id=8, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[8,1]),4], points=cen[which(t_atr$COUNTY==town[8,1]),1:2])
p9 <- mean_centre(id=9, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[9,1]),4], points=cen[which(t_atr$COUNTY==town[9,1]),1:2])
p10 <- mean_centre(id=10, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[10,1]),4], points=cen[which(t_atr$COUNTY==town[10,1]),1:2])
p11 <- mean_centre(id=11, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[11,1]),4], points=cen[which(t_atr$COUNTY==town[11,1]),1:2])
p12 <- mean_centre(id=12, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[12,1]),4], points=cen[which(t_atr$COUNTY==town[12,1]),1:2])
p13 <- mean_centre(id=13, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[13,1]),4], points=cen[which(t_atr$COUNTY==town[13,1]),1:2])
p14 <- mean_centre(id=14, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[14,1]),4], points=cen[which(t_atr$COUNTY==town[14,1]),1:2])
p15 <- mean_centre(id=15, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[15,1]),4], points=cen[which(t_atr$COUNTY==town[15,1]),1:2])
p16 <- mean_centre(id=16, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[16,1]),4], points=cen[which(t_atr$COUNTY==town[16,1]),1:2])
p17 <- mean_centre(id=17, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[17,1]),4], points=cen[which(t_atr$COUNTY==town[17,1]),1:2])
p18 <- mean_centre(id=18, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[18,1]),4], points=cen[which(t_atr$COUNTY==town[18,1]),1:2])
p19 <- mean_centre(id=19, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[19,1]),4], points=cen[which(t_atr$COUNTY==town[19,1]),1:2])
p20 <- mean_centre(id=20, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[20,1]),4], points=cen[which(t_atr$COUNTY==town[20,1]),1:2])
p21 <- mean_centre(id=21, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[21,1]),4], points=cen[which(t_atr$COUNTY==town[21,1]),1:2])
p22 <- mean_centre(id=22, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[22,1]),4], points=cen[which(t_atr$COUNTY==town[22,1]),1:2])
p23 <- mean_centre(id=23, weighted=TRUE, weights=t_atr[which(t_atr$COUNTY==town[23,1]),4], points=cen[which(t_atr$COUNTY==town[23,1]),1:2])
p <- rbind(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15, p16, p17, p18, p19, p20, p21, p22, p23)

plot(t, main="各縣市幾何中心、人口中心點")
points(c1, pch=16, col="red")
points(c2, pch=16, col="red")
points(c3, pch=16, col="red")
points(c4, pch=16, col="red")
points(c5, pch=16, col="red")
points(c6, pch=16, col="red")
points(c7, pch=16, col="red")
points(c8, pch=16, col="red")
points(c9, pch=16, col="red")
points(c10, pch=16, col="red")
points(c11, pch=16, col="red")
points(c12, pch=16, col="red")
points(c13, pch=16, col="red")
points(c14, pch=16, col="red")
points(c15, pch=16, col="red")
points(c16, pch=16, col="red")
points(c17, pch=16, col="red")
points(c18, pch=16, col="red")
points(c19, pch=16, col="red")
points(c20, pch=16, col="red")
points(c21, pch=16, col="red")
points(c22, pch=16, col="red")
points(c23, pch=16, col="red")
points(p$CENTRE.x, p$CENTRE.y, pch=16, col="blue")
legend(5000, 2550000, c("幾何中心", "人口中心"), col=c("red", "blue"), pch=16)
```

